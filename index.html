<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ファビアチェック - 恐怖症の方も安心して映画を楽しめる</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1387560637754446" crossorigin="anonymous"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .logo {
            font-size: 3em;
            font-weight: bold;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }

        .description {
            background: linear-gradient(45deg, #ffeaa7, #fab1a0);
            padding: 15px;
            border-radius: 15px;
            margin: 10px 0;
            font-weight: bold;
        }

        .nav-links {
            margin-top: 20px;
        }

        .nav-links a {
            color: #667eea;
            text-decoration: none;
            margin: 0 15px;
            font-weight: bold;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #764ba2;
        }

        .search-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 15px;
            border: 3px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-btn {
            padding: 15px 30px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: transform 0.2s;
        }

        .search-btn:hover {
            transform: translateY(-2px);
        }

        .movie-sections {
            display: grid;
            gap: 30px;
        }

        .movie-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }

        .movie-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .movie-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .movie-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .movie-poster {
            width: 100%;
            height: 200px;
            background: #f0f0f0;
            border-radius: 10px;
            margin-bottom: 10px;
            background-size: cover;
            background-position: center;
        }

        .movie-title {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .movie-year {
            color: #666;
            font-size: 0.8em;
            margin-bottom: 10px;
        }

        .phobia-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .phobia-tag {
            background: linear-gradient(45deg, #ff9a9e, #fecfef);
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 0.7em;
            color: #333;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: black;
        }

        .phobia-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
        }

        .submit-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            margin-top: 20px;
        }

        .ad-space {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
            color: #6c757d;
        }

        .loading {
            text-align: center;
            padding: 20px;
            font-size: 1.2em;
            color: #667eea;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .logo {
                font-size: 2em;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            .movie-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">🎬 ファビアチェック</div>
            <div class="subtitle">恐怖症の方も安心して映画を楽しめる情報サイト</div>
            <div class="description">
                ファビオ（恐怖症）をお持ちの方が、事前に恐怖要素を把握して安心して映画鑑賞を楽しめるサイトです
            </div>
            <div class="nav-links">
                <a href="#" onclick="showAbout()">サイト説明</a> | 
                <a href="#" onclick="showDisclaimer()">免責事項</a>
            </div>
        </header>

        <div class="ad-space">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-1387560637754446"
                 data-ad-slot="1234567890"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>

        <div class="search-section">
            <h2 style="text-align: center; margin-bottom: 20px; color: #667eea;">🔍 映画タイトル検索</h2>
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="映画タイトルを入力してください...">
                <button class="search-btn" onclick="searchMovies()">検索</button>
            </div>
            <div id="searchResults"></div>
        </div>

        <div class="movie-sections">
            <div class="movie-section">
                <h2 class="section-title">🎪 公開予定の映画</h2>
                <div class="movie-grid" id="upcomingMovies">
                    <div class="loading">映画情報を読み込み中...</div>
                </div>
            </div>

            <div class="ad-space">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-1387560637754446"
                     data-ad-slot="9876543210"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
            </div>

            <div class="movie-section">
                <h2 class="section-title">🎥 上映中の映画</h2>
                <div class="movie-grid" id="nowPlayingMovies">
                    <div class="loading">映画情報を読み込み中...</div>
                </div>
            </div>

            <div class="movie-section">
                <h2 class="section-title">🔥 話題の映画</h2>
                <div class="movie-grid" id="popularMovies">
                    <div class="loading">映画情報を読み込み中...</div>
                </div>
            </div>

            <div class="ad-space">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-1387560637754446"
                     data-ad-slot="1122334455"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
            </div>

            <div class="movie-section">
                <h2 class="section-title">⭐ 評価の高い映画</h2>
                <div class="movie-grid" id="topRatedMovies">
                    <div class="loading">映画情報を読み込み中...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 恐怖症情報追加・編集モーダル -->
    <div id="phobiaModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle">恐怖症情報を追加・編集</h2>
            <div id="modalMovieInfo"></div>
            
            <h3>恐怖要素をチェックしてください：</h3>
            <div class="phobia-checkboxes">
                <div class="checkbox-item">
                    <input type="checkbox" id="heights" value="高所">
                    <label for="heights">高所</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="enclosed" value="閉所">
                    <label for="enclosed">閉所</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="darkness" value="暗所">
                    <label for="darkness">暗所</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="spiders" value="蜘蛛">
                    <label for="spiders">蜘蛛</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="butterflies" value="蝶">
                    <label for="butterflies">蝶</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ants" value="蟻">
                    <label for="ants">蟻</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="insects" value="昆虫">
                    <label for="insects">昆虫</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="frogs" value="蛙">
                    <label for="frogs">蛙</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="snakes" value="ヘビ">
                    <label for="snakes">ヘビ</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="clusters" value="集合体">
                    <label for="clusters">集合体</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="blood" value="血液描写">
                    <label for="blood">血液描写</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="water" value="水・溺水">
                    <label for="water">水・溺水</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="thunder" value="雷">
                    <label for="thunder">雷</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="vomit" value="嘔吐">
                    <label for="vomit">嘔吐</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="needles" value="注射・先端">
                    <label for="needles">注射・先端</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="clowns" value="ピエロ">
                    <label for="clowns">ピエロ</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ghosts" value="幽霊・超常現象">
                    <label for="ghosts">幽霊・超常現象</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="sexual" value="性的シーン">
                    <label for="sexual">性的シーン</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="corpses" value="死体">
                    <label for="corpses">死体</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="others" value="その他">
                    <label for="others">その他</label>
                </div>
            </div>
            
            <button class="submit-btn" onclick="submitPhobiaInfo()">情報を保存</button>
        </div>
    </div>

    <script>
        const API_KEY = '9c5b6fe18f36543b858effdaf87e44e0';
        const BASE_URL = 'https://api.themoviedb.org/3';
        const IMAGE_BASE_URL = 'https://image.tmdb.org/t/p/w500';
        
        // 恐怖症情報を保存するオブジェクト（実際の実装ではデータベースを使用）
        let phobiaData = {};
        
        // サンプル恐怖症データの生成
        function generateSamplePhobiaData() {
            const phobiaTypes = ['高所', '閉所', '暗所', '蜘蛛', '蝶', '蟻', '昆虫', '蛙', 'ヘビ', '集合体', '血液描写', '水・溺水', '雷', '嘔吐', '注射・先端', 'ピエロ', '幽霊・超常現象', '性的シーン', '死体', 'その他'];
            
            // 人気映画のIDリストに対してランダムに恐怖症情報を付与
            const movieIds = [550, 278, 238, 680, 129, 155, 497, 424, 13, 769, 19995, 157, 120, 11, 807, 857, 103, 161, 680, 274, 429, 420, 765, 578, 475, 335, 100, 20, 73, 680];
            
            movieIds.forEach(id => {
                const randomPhobias = [];
                const numPhobias = Math.floor(Math.random() * 4); // 0-3個の恐怖症要素
                
                for (let i = 0; i < numPhobias; i++) {
                    const randomPhobia = phobiaTypes[Math.floor(Math.random() * phobiaTypes.length)];
                    if (!randomPhobias.includes(randomPhobia)) {
                        randomPhobias.push(randomPhobia);
                    }
                }
                
                if (randomPhobias.length > 0) {
                    phobiaData[id] = randomPhobias;
                }
            });
        }
        
        let currentMovieId = null;
        
        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            generateSamplePhobiaData();
            loadMovieSections();
            
            // Google AdSense初期化
            (adsbygoogle = window.adsbygoogle || []).push({});
        });
        
        // 映画情報をTMDBから取得
        async function fetchMovies(endpoint) {
            try {
                const response = await fetch(`${BASE_URL}${endpoint}?api_key=${API_KEY}&language=ja-JP&region=JP`);
                const data = await response.json();
                return data.results || [];
            } catch (error) {
                console.error('映画データの取得に失敗しました:', error);
                return [];
            }
        }
        
        // 映画検索
        async function searchMovies() {
            const query = document.getElementById('searchInput').value.trim();
            if (!query) return;
            
            const resultsDiv = document.getElementById('searchResults');
            resultsDiv.innerHTML = '<div class="loading">検索中...</div>';
            
            try {
                const response = await fetch(`${BASE_URL}/search/movie?api_key=${API_KEY}&language=ja-JP&query=${encodeURIComponent(query)}`);
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    resultsDiv.innerHTML = '<h3>検索結果:</h3><div class="movie-grid">' + 
                        data.results.slice(0, 20).map(movie => createMovieCard(movie)).join('') + '</div>';
                } else {
                    resultsDiv.innerHTML = '<p>検索結果が見つかりませんでした。</p>';
                }
            } catch (error) {
                resultsDiv.innerHTML = '<p>検索中にエラーが発生しました。</p>';
            }
        }
        
        // 各セクションの映画を読み込み
        async function loadMovieSections() {
            const sections = [
                { id: 'upcomingMovies', endpoint: '/movie/upcoming' },
                { id: 'nowPlayingMovies', endpoint: '/movie/now_playing' },
                { id: 'popularMovies', endpoint: '/movie/popular' },
                { id: 'topRatedMovies', endpoint: '/movie/top_rated' }
            ];
            
            for (const section of sections) {
                const movies = await fetchMovies(section.endpoint);
                const container = document.getElementById(section.id);
                if (movies.length > 0) {
                    container.innerHTML = movies.slice(0, 20).map(movie => createMovieCard(movie)).join('');
                } else {
                    container.innerHTML = '<p>映画情報を取得できませんでした。</p>';
                }
            }
        }
        
        // 映画カードを作成
        function createMovieCard(movie) {
            const posterPath = movie.poster_path ? `${IMAGE_BASE_URL}${movie.poster_path}` : '';
            const releaseYear = movie.release_date ? new Date(movie.release_date).getFullYear() : '未定';
            const phobias = phobiaData[movie.id] || [];
            
            return `
                <div class="movie-card" onclick="openPhobiaModal(${movie.id}, '${movie.title.replace(/'/g, "\\'")}', '${posterPath}', ${releaseYear})">
                    <div class="movie-poster" style="background-image: url('${posterPath}')"></div>
                    <div class="movie-title">${movie.title}</div>
                    <div class="movie-year">${releaseYear}</div>
                    <div class="phobia-tags">
                        ${phobias.map(phobia => `<span class="phobia-tag">${phobia}</span>`).join('')}
                        ${phobias.length === 0 ? '<span class="phobia-tag" style="background: #e8f5e8;">情報なし</span>' : ''}
                    </div>
                </div>
            `;
        }
        
        // 恐怖症情報モーダルを開く
        function openPhobiaModal(movieId, title, poster, year) {
            currentMovieId = movieId;
            document.getElementById('modalTitle').textContent = `${title} の恐怖症情報`;
            document.getElementById('modalMovieInfo').innerHTML = `
                <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                    <img src="${poster}" alt="${title}" style="width: 100px; height: 150px; object-fit: cover; border-radius: 10px;">
                    <div>
                        <h3>${title}</h3>
                        <p>公開年: ${year}</p>
                        <p>現在の恐怖症情報を確認・編集できます</p>
                    </div>
                </div>
            `;
            
            // 既存の恐怖症情報をチェック
            const existingPhobias = phobiaData[movieId] || [];
            const checkboxes = document.querySelectorAll('#phobiaModal input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = existingPhobias.includes(checkbox.value);
            });
            
            document.getElementById('phobiaModal').style.display = 'block';
        }
        
        // モーダルを閉じる
        function closeModal() {
            document.getElementById('phobiaModal').style.display = 'none';
        }
        
        // 恐怖症情報を保存
        function submitPhobiaInfo() {
            if (!currentMovieId) return;
            
            const checkedPhobias = [];
            const checkboxes = document.querySelectorAll('#phobiaModal input[type="checkbox"]:checked');
            checkboxes.forEach(checkbox => {
                checkedPhobias.push(checkbox.value);
            });
            
            phobiaData[currentMovieId] = checkedPhobias;
            
            alert('恐怖症情報が保存されました！');
            closeModal();
            
            // 画面を更新して変更を反映
            loadMovieSections();
        }
        
        // サイト説明を表示
        function showAbout() {
            alert(`ファビアチェックについて

このサイトは、ファビオ（恐怖症）をお持ちの方が映画を安心して楽しめるよう、事前に恐怖要素を確認できる情報提供サイトです。

【機能】
・映画タイトル検索
・恐怖症要素のタグ表示
・ユーザー参加型の情報追加・編集
・公開予定・上映中・人気・高評価映画の表示

【対応している恐怖症要素】
高所、閉所、暗所、蜘蛛、蝶、蟻、昆虫、蛙、ヘビ、集合体、血液描写、水・溺水、雷、嘔吐、注射・先端、ピエロ、幽霊・超常現象、性的シーン、死体、その他

皆様からの情報提供により、より多くの方が安心して映画を楽しめるサイトを目指しています。`);
        }
        
        // 免責事項を表示
        function showDisclaimer() {
            alert(`免責事項

【情報の正確性について】
本サイトの恐怖症情報は、ユーザーの皆様からの投稿によるものです。情報の正確性については保証いたしかねます。

【個人差について】
恐怖症の感じ方には個人差があります。本サイトの情報を参考にしつつ、最終的な判断はご自身でお願いいたします。

【責任の限界】
本サイトの利用により生じた損害について、運営者は一切の責任を負いません。

【外部サービス】
映画データはThe Movie Database (TMDB) APIを使用しています。

【データ収集】
本サイトはGoogle AdSenseを使用しており、Cookieによる情報収集が行われる場合があります。

ご不明な点がございましたら、お気軽にお問い合わせください。`);
        }
        
        // Enter キーで検索
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchMovies();
            }
        });
        
        // モーダル外クリックで閉じる
        window.onclick = function(event) {
            const modal = document.getElementById('phobiaModal');
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
