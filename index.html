<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>恐怖症フレンドリー映画検索</title>
  <script>
    async function searchMovie() {
      const title = document.getElementById('movie-title').value;
      const apiKey = '9c5b6fe18f36543b858effdaf87e44e0';
      const response = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&query=${encodeURIComponent(title)}`);
      const data = await response.json();

      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      if (data.results && data.results.length > 0) {
        const movie = data.results[0];
        resultsDiv.innerHTML = `
          <h2>${movie.title}</h2>
          <p>${movie.overview}</p>
          <p>公開日: ${movie.release_date}</p>
          <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title} poster">
          <div id="phobia-tags">
            <h3>恐怖要素（登録されている場合）:</h3>
            <ul id="phobia-list"></ul>
          </div>
        `;
        // 恐怖タグの取得（仮のデータベース想定）
        loadPhobiaTags(movie.id);
      } else {
        resultsDiv.innerHTML = '<p>該当する映画が見つかりませんでした。</p>';
      }
    }

    function loadPhobiaTags(movieId) {
      // ダミーで登録された恐怖タグを表示（本番ではデータベース連携）
      const dummyTags = {
        12345: ["高所", "血液描写", "死体"],
        67890: ["蜘蛛", "昆虫", "集合体"]
      };
      const phobias = dummyTags[movieId] || ["恐怖要素未登録"];
      const ul = document.getElementById('phobia-list');
      ul.innerHTML = '';
      phobias.forEach(phobia => {
        const li = document.createElement('li');
        li.textContent = phobia;
        ul.appendChild(li);
      });
    }
  </script>
</head>
<body>
  <header>
    <h1>恐怖症フレンドリー映画検索</h1>
    <p>あなたの恐怖症に配慮した映画選びをサポートします。</p>
  </header>

  <main>
    <section>
      <label for="movie-title">映画タイトルを入力:</label>
      <input type="text" id="movie-title">
      <button onclick="searchMovie()">検索</button>
    </section>
    <section id="results"></section>

    <section>
      <h2>恐怖要素の新規登録フォーム</h2>
      <form action="#" method="POST">
        <label>映画タイトル: <input type="text" name="title" required></label><br>
        <label>TMDB 映画ID: <input type="text" name="movie_id" required></label><br>
        <label>該当する恐怖要素:</label><br>
        <div>
          <label><input type="checkbox" name="phobias" value="高所"> 高所</label>
          <label><input type="checkbox" name="phobias" value="閉所"> 閉所</label>
          <label><input type="checkbox" name="phobias" value="暗所"> 暗所</label>
          <label><input type="checkbox" name="phobias" value="蜘蛛"> 蜘蛛</label>
          <label><input type="checkbox" name="phobias" value="蝶"> 蝶</label>
          <label><input type="checkbox" name="phobias" value="蟻"> 蟻</label>
          <label><input type="checkbox" name="phobias" value="昆虫"> 昆虫</label>
          <label><input type="checkbox" name="phobias" value="蛙"> 蛙</label>
          <label><input type="checkbox" name="phobias" value="ヘビ"> ヘビ</label>
          <label><input type="checkbox" name="phobias" value="集合体"> 集合体</label>
          <label><input type="checkbox" name="phobias" value="血液描写"> 血液描写</label>
          <label><input type="checkbox" name="phobias" value="水・溺水"> 水・溺水</label>
          <label><input type="checkbox" name="phobias" value="雷"> 雷</label>
          <label><input type="checkbox" name="phobias" value="嘔吐"> 嘔吐</label>
          <label><input type="checkbox" name="phobias" value="注射・先端"> 注射・先端</label>
          <label><input type="checkbox" name="phobias" value="ピエロ"> ピエロ</label>
          <label><input type="checkbox" name="phobias" value="幽霊・超常現象"> 幽霊・超常現象</label>
          <label><input type="checkbox" name="phobias" value="性的シーン"> 性的シーン</label>
          <label><input type="checkbox" name="phobias" value="死体"> 死体</label>
          <label><input type="checkbox" name="phobias" value="その他"> その他</label>
        </div><br>
        <button type="submit">登録する</button>
      </form>
    </section>
  </main>

  <footer>
    <p><a href="about.html">このサイトについて</a> | <a href="disclaimer.html">免責事項</a></p>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
         data-ad-slot="XXXXXXXXXX"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </footer>
</body>
</html>
