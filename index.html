<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>恐怖症映画検索</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans JP', sans-serif;
      background: linear-gradient(to bottom, #e0f7fa, #fff);
      color: #333;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #006064;
      color: white;
      padding: 1em;
      text-align: center;
    }
    main {
      padding: 2em;
      max-width: 800px;
      margin: auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    section {
      margin-bottom: 2em;
    }
    input[type="text"] {
      width: 70%;
      padding: 0.5em;
      margin: 0.5em 0;
      font-size: 1em;
    }
    button {
      padding: 0.5em 1em;
      font-size: 1em;
      background-color: #00796b;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #004d40;
    }
    footer {
      text-align: center;
      padding: 2em;
      background-color: #004d40;
      color: white;
      margin-top: 2em;
    }
    .movie-result {
      margin-bottom: 2em;
      border-bottom: 1px solid #ccc;
      padding-bottom: 1em;
    }
    .movie-result img {
      max-width: 100%;
      border-radius: 8px;
    }
    #phobia-tags ul {
      list-style: none;
      padding-left: 0;
    }
    #phobia-tags li {
      display: inline-block;
      background: #ffe082;
      padding: 0.4em 0.8em;
      margin: 0.3em;
      border-radius: 20px;
      font-size: 0.9em;
    }
    form div label {
      display: inline-block;
      margin-right: 1em;
      margin-bottom: 0.3em;
    }
  </style>
  <script>
    async function searchMovie() {
      const title = document.getElementById('movie-title').value;
      const apiKey = '9c5b6fe18f36543b858effdaf87e44e0';
      const response = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&query=${encodeURIComponent(title)}&language=ja`);
      const data = await response.json();

      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      if (data.results && data.results.length > 0) {
        data.results.forEach(movie => {
          const movieDiv = document.createElement('div');
          movieDiv.classList.add('movie-result');
          movieDiv.innerHTML = `
            <h2>${movie.title}</h2>
            <p>${movie.overview || '説明が見つかりませんでした。'}</p>
            <p>公開日: ${movie.release_date}</p>
            <p><strong>TMDB 映画ID:</strong> ${movie.id}</p>
            <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title} poster">
            <div class="phobia-tags">
              <h3>恐怖要素（登録されている場合）:</h3>
              <ul id="phobia-list-${movie.id}"></ul>
            </div>
          `;
          resultsDiv.appendChild(movieDiv);
          loadPhobiaTags(movie.id);
        });
      } else {
        resultsDiv.innerHTML = '<p>該当する映画が見つかりませんでした。</p>';
      }
    }

    function loadPhobiaTags(movieId) {
      const dummyTags = {
        12345: ["高所", "血液描写", "死体"],
        67890: ["蜘蛛", "昆虫", "集合体"]
      };
      const phobias = dummyTags[movieId] || ["恐怖要素未登録"];
      const ul = document.getElementById(`phobia-list-${movieId}`);
      ul.innerHTML = '';
      phobias.forEach(phobia => {
        const li = document.createElement('li');
        li.textContent = phobia;
        ul.appendChild(li);
      });
    }
  </script>
</head>
<body>
  <header>
    <h1>恐怖症映画検索</h1>
    <p>安心して映画を観るために</p>
  </header>

  <main>
    <section>
      <label for="movie-title">映画タイトルを入力:</label><br>
      <input type="text" id="movie-title">
      <button onclick="searchMovie()">検索</button>
    </section>
    <section id="results"></section>

    <section>
      <h2>恐怖要素の新規登録フォーム</h2>
      <form action="#" method="POST">
        <label>映画タイトル: <input type="text" name="title" required></label><br>
        <label>TMDB 映画ID: <input type="text" name="movie_id"></label>
        <p style="font-size: 0.9em; color: #555;">※映画IDが不明な場合は、上の検索欄で映画を検索するとIDが表示されます。</p><br>
        <label>該当する恐怖要素:</label><br>
        <div>
          <label><input type="checkbox" name="phobias" value="高所"> 高所</label>
          <label><input type="checkbox" name="phobias" value="閉所"> 閉所</label>
          <label><input type="checkbox" name="phobias" value="暗所"> 暗所</label>
          <label><input type="checkbox" name="phobias" value="蜘蛛"> 蜘蛛</label>
          <label><input type="checkbox" name="phobias" value="蝶"> 蝶</label>
          <label><input type="checkbox" name="phobias" value="蟻"> 蟻</label>
          <label><input type="checkbox" name="phobias" value="昆虫"> 昆虫</label>
          <label><input type="checkbox" name="phobias" value="蛙"> 蛙</label>
          <label><input type="checkbox" name="phobias" value="ヘビ"> ヘビ</label>
          <label><input type="checkbox" name="phobias" value="集合体"> 集合体</label>
          <label><input type="checkbox" name="phobias" value="血液描写"> 血液描写</label>
          <label><input type="checkbox" name="phobias" value="水・溺水"> 水・溺水</label>
          <label><input type="checkbox" name="phobias" value="雷"> 雷</label>
          <label><input type="checkbox" name="phobias" value="嘔吐"> 嘔吐</label>
          <label><input type="checkbox" name="phobias" value="注射・先端"> 注射・先端</label>
          <label><input type="checkbox" name="phobias" value="ピエロ"> ピエロ</label>
          <label><input type="checkbox" name="phobias" value="幽霊・超常現象"> 幽霊・超常現象</label>
          <label><input type="checkbox" name="phobias" value="性的シーン"> 性的シーン</label>
          <label><input type="checkbox" name="phobias" value="死体"> 死体</label>
          <label><input type="checkbox" name="phobias" value="その他"> その他</label>
        </div><br>
        <button type="submit">登録する</button>
      </form>
    </section>
  </main>

  <footer>
    <p><a href="about.html">このサイトについて</a> | <a href="disclaimer.html">免責事項</a></p>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
         data-ad-slot="XXXXXXXXXX"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </footer>
</body>
</html>
